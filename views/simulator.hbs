<!-- partial:index.partial.html -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

  <!-- Styles -->
 <!-- Updated Styles for Modern and Intuitive UI -->
<style>
  body {
    background-color: #1e1e1e; /* Dark gray background */
    color: #f5f5f5; /* Lighter text */
    font-family: 'Poppins', sans-serif;
  }

  .sidebar-wrapper {
    background-color: #2c2c2c; /* Dark background for sidebar */
    color: #f5f5f5;
    padding: 20px;
  }

  .sidebar-wrapper a {
    color: #a5a5a5;
    transition: color 0.3s ease;
  }

  .sidebar-wrapper a:hover {
    color: #ffffff; /* Highlighted on hover */
  }

  .sidebar-wrapper .sidebar-menu .header-menu span {
    font-size: 1.2em;
    color: #ffffff;
    padding: 10px;
  }

  .sidebar-wrapper .btn-success {
    background-color: #28a745;
    border-color: #28a745;
    padding: 10px;
    font-size: 1em;
  }

  .sidebar-wrapper .btn-danger {
    background-color: #dc3545;
    border-color: #dc3545;
    padding: 10px;
    font-size: 1em;
  }

  .container input, .form-select {
    border-radius: 5px;
    border: 1px solid #444;
    padding: 10px;
    background-color: #2c2c2c;
    color: #fff;
  }

  /* News Card Style */
  .card {
    background-color: #2e2e2e;
    border: none;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    border-radius: 10px;
    color: #f5f5f5;
  }

  .card-title {
    color: #ffffff;
  }

  .card-body .btn-primary {
    background-color: #007bff;
    border-color: #007bff;
    padding: 8px 16px;
    border-radius: 20px;
  }

  /* Button Hover Effects */
  .btn-success:hover {
    background-color: #218838;
  }

  .btn-danger:hover {
    background-color: #c82333;
  }

  .card-body .btn-primary:hover {
    background-color: #0069d9;
  }

  /* Sidebar toggle button */
  #show-sidebar {
    position: fixed;
    top: 20px;
    left: 20px;
    background-color: #2c2c2c;
    color: white;
    padding: 10px;
    border-radius: 50%;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    cursor: pointer;
  }

  /* Chart styling */
  #chart {
    background-color: #1e1e1e;
    border-radius: 10px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  }

  /* Responsive Design */
  @media (max-width: 768px) {
    #chart {
      width: 100%;
    }

    .sidebar-wrapper {
      width: 100%;
      position: fixed;
      top: 0;
      left: -100%;
      transition: left 0.3s ease;
    }

    .sidebar-wrapper.active {
      left: 0;
    }
  }
</style>


<body>
  
<div class="page-wrapper chiller-theme toggled" id="simulator">
  <a id="show-sidebar" class="btn btn-sm btn-dark" href="#">
    <i class="fas fa-bars" onclick="resetWindowSize()"></i>
  </a>
  <nav id="sidebar" class="sidebar-wrapper">
    <div class="sidebar-content">
      <div class="sidebar-brand">
        <a href="/">InvestX</a>
        <div id="close-sidebar" onclick="changeWindowSize()">
          <i class="fas fa-times"></i>
        </div>
      </div>
      <div class="sidebar-header">
        <div class="user-pic">
          <img class="img-responsive img-rounded" src="https://ui-avatars.com/api/?name={{user.name}}"
            alt="User picture">
        </div>
        <div class="user-info">
          <span class="user-name">{{user.name}}
          </span>
          <span class="user-role">User</span>
          <span class="user-status">
            <i class="fa fa-circle"></i>
            <span>Online</span>
          </span>
        </div>
      </div>
      <!-- sidebar-header  -->
      <div class="sidebar-search">
        <div>
          <div class="input-group">
            <input type="text" class="form-control search-menu" placeholder="Search...">
            <div class="input-group-append">
              <span class="input-group-text">
                <i class="fa fa-search" style="height: 25px; padding-top:5px" aria-hidden="true"></i>
              </span>
            </div>
          </div>
        </div>
      </div>
      <!-- sidebar-search  -->
      <div class="sidebar-menu" style="color: white;">
        <ul>
          <li class="header-menu">
            <span>Information</span>
          </li>

          <li class="sidebar-dropdown">
            <a href="#">
              <i class="fa fa-chart-line"></i>
              <span>Current Buying Price </span>
            </a>
            <div class="sidebar-submenu">
              <ul>
                <li>
                  <a href="#" id="cbp"></a>
                </li>
              </ul>
            </div>
          </li>
          <li class="sidebar-dropdown">
            <a href="#">
              <i class="fa fa-globe"></i>
              <span>Available Balance </span>
            </a>
            <div class="sidebar-submenu">
              <ul>
                <li>
                  <a href="#" id="abl">₹ 100000.00</a>
                </li>
              </ul>
            </div>
          </li>
          <li class="header-menu">
            <span>Purchase</span>
            <div class="container" style="margin-left: 5px;">
              <input type="number" name="stockcount" id="stockcount" style="width: 90%;" class="form-control">
            </div>
            {{!-- <span>Total Amount : </span>
            <br>
            <span id="totamt" ></span> --}}
            <br>
            <div class="container" style="margin-left: 5px;">
              <button class="btn btn-success" onclick="buyStock()">Buy</button>
              &nbsp;&nbsp;&nbsp;
              <button class="btn btn-danger" onclick="sellStock()">Sell</button>
            </div>

          </li>
          <hr>
          <li class="header-menu">
            <span style="font-size: larger; margin-bottom:-100px;">Portfolio :</span>
            <br>
            <span id="portfolio" style="margin-top:-100px">₹ 100000.00</span>
          </li>
          <li class="header-menu">
            <span>Recent Transaction : </span>
            <br>
            <span id="rt"></span>

          </li>
        </ul>
      </div>
      <!-- sidebar-menu  -->
    </div>
    <!-- sidebar-content  -->
    <div class="sidebar-footer">
      <a href="#">
        <span>Back to Home Page</span>
      </a>
    </div>
  </nav>
  <!-- sidebar-wrapper  -->
  <div class="float-container">
    <h1>TRADING TERMINAL</h1>
    <div class="float-child-chart" id='chart' style="width: 60%;">
      &nbsp;
      &nbsp;
      &nbsp;
      &nbsp;
      &nbsp;
      <br>
      <br>
      <label for="companies">Select Stock : </label>
      <select id="companies" class="form-select" name="companies"
        style="width: 50%; display:inline-block; margin-top:-3px">
        <option value="RELIANCE">Reliance</option>
        <option value="BAJFINANCE">Bajaj Finance</option>
        <option value="HINDUNILVR">Hindu Unilever Ltd.</option>
        <option value="HDFC">HDFC</option>
        <option value="SBIN">State Bank of India</option>
        <option value="ITC">ITC Ltd.</option>
        <option value="MARUTI">Maruti Suzuki India Ltd.</option>
        <option value="TCS">Tata Consultancy Services Ltd.</option>
        <option value="INFY">Infosys</option>
        <option value="HCLTECH">HCL Technologies</option>
        <option value="HINDALCO">Hindalco Industries Ltd.</option>
        <option value="ADANITRANS">Adani Transmission Ltd.</option>
        <option value="ULTRACEMCO">UltraTech Cement Ltd.</option>
        <option value="NESTLEIND">Nestle India Ltd.</option>
        <option value="TATASTEEL">TATA Steel</option>
        <option value="ADANIPORTS">Adani Ports and Special Economic Ltd.</option>
        <option value="ONGC">Oil and Natural Gas Corporation Ltd.</option>
        <option value="DABUR">Dabur India Ltd.</option>
        <option value="BPCL">Bharat Petroleum Corporation Ltd.</option>
        <option value="YESBANK">Yes Bank</option>
        <option value="GAIL">GAIL (India) Ltd.</option>
        <option value="COLPAL">Colgate-Palmolive India Ltd.</option>
      </select>
      <button style="display:inline-block" type="button" onclick="Chart()" class="btn btn-success"><b>View
          Analysis</b></button>
      <br>
      <br>
    </div>
    <br>
      <br>
      <br>
      <br>
    <div class="float-child-line " ></div>
    <div class="float-child-news" id='news'>
      <div class="card text-center" style="width: 20rem;">
        <div class="card-body">
          <h5 class="card-title" id="newsa">Trending Topics
Live now
auto refresh 
Stock Market LIVE Updates: Nifty crosses 26,100, Sensex above 85,500; Nifty Bank at fresh high</h5>
          <p class="card-text" id="sa"></p>
          <a href="https://www.moneycontrol.com/news/business/markets/stock-market-live-sensex-nifty-50-share-price-gift-nifty-latest-updates-26-09-2024-liveblog-12829738.html" class="btn btn-primary" id="linka"  target="_blank">View More</a>
        </div>
      </div>
      <br>

      <div class="card text-center" style="width: 20rem;">
        <div class="card-body">
          <h5 class="card-title" id="newsb">EaseMyTrip signs deal to launch hotels segment on PhonePe, shares jump 6%</h5>
          <p class="card-text" id="sb"></p>
          <a href="https://www.moneycontrol.com/news/business/markets/easemytrip-signs-deal-to-launch-hotels-segment-on-phonepe-shares-jump-6-12829938.html" class="btn btn-primary" id="linkb" target="_blank">View More</a>
        </div>
      </div>
      <br>

      <div class="card text-center" style="width: 20rem;">
        <div class="card-body">
          <h5 class="card-title" id="newsc">RIEX shares bounce back 4% after two-day fall; Investec initiates 'long fast'</h5>
          <p class="card-text" id="sc"></p>
          <a href="https://www.moneycontrol.com/news/business/markets/iex-shares-bounce-back-4-after-two-day-fall-investec-initiates-long-fast-12829952.html" class="btn btn-primary" id="linkc"  target="_blank" >View More</a>
        </div>
      </div>
      <br>
      <br>
    </div>
  </div>

  
    
  </body>
  <script src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>
  <script>
    function resetWindowSize() {
      document.getElementById('simulator').style.marginLeft = "20%";
    }

    function changeWindowSize() {
      document.getElementById('simulator').style.marginLeft = "5%";
    }
    resetWindowSize();

    function sleep(ms) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }

    const chartProperties = {
      width: 700,
      height: 540,
      timeScale: {
        timeVisible: true,
        secondsVisible: false,
      },
      layout: {
        textColor: 'rgba(0, 0, 0, 0.9)',
      },
      grid: {
        vertLines: {
          color: 'rgba(197, 203, 206, 0.5)',
        },
        horzLines: {
          color: 'rgba(197, 203, 206, 0.5)',
        },
      },
      crosshair: {
        mode: LightweightCharts.CrosshairMode.Normal,
      },
      rightPriceScale: {
        borderColor: 'rgba(197, 203, 206, 0.8)',
      },
      timeScale: {
        borderColor: 'rgba(197, 203, 206, 0.8)',
      },
    }
    const domElement = document.getElementById('chart');
    const chart = LightweightCharts.createChart(domElement, chartProperties);
    const candleSeries = chart.addCandlestickSeries();

    var cdata;
    var flag = true;
    async function Chart() {
      for (i = 1; i < 365; i++) {
        if (i == 1) {
          fetch(`http://localhost:9000/getdata/` + i)
            .then(res => res.json())
            .then(data => {
              cdata = data.map(d => {
                 document.getElementById('cbp').innerHTML = "₹ " + d.Last_Price;

                return { time: d.Date, open: parseFloat(d.Open_Price), high: parseFloat(d.High_Price), low: parseFloat(d.Low_Price), close: parseFloat(d.Close_Price) }
              });
              candleSeries.setData(cdata);
            })
            .catch(err => log(err))
        }
        else {
          fetch(`http://localhost:9000/getdata/` + i)
            .then(res => res.json())
            .then(data => {
              cdata = data.map(d => {
                 document.getElementById('cbp').innerHTML = "₹ " + d.Last_Price;
                return { time: d.Date, open: parseFloat(d.Open_Price), high: parseFloat(d.High_Price), low: parseFloat(d.Low_Price), close: parseFloat(d.Close_Price) }
              });
              candleSeries.setData(cdata);
            })
            .catch(err => log(err))
        }
        if(!flag) {
          break;
        }
        await sleep(500);
      }
    }
    Chart();
    var b = 0;
    var avail = 100000;
    var ns = 0;
    var curr_date = "";
    function buyStock() {
      var num = Number(document.getElementById('stockcount').value);
      var f = confirm("Buy Stock\nTotal Amount: " + "₹ " + (num*Number(document.getElementById('cbp').innerHTML.slice(2))));
      if(f) {
        ns += num;
        var bbbb = Number(document.getElementById('cbp').innerHTML.slice(2));
        avail = avail - (num*bbbb);
        document.getElementById('abl').innerHTML = avail;
        b = 1;

        document.getElementById('rt').innerHTML = `
            Order : Buy <br>
            Stock : ` + document.getElementById('companies').value + `<br>
            Qty : ` + num + `<br>
            Price : ₹ ` + bbbb + `<br>
            Date : ` + curr_date + `<br>
        `;
      }
    }

    function sellStock() {
      var num = Number(document.getElementById('stockcount').value);
      if(num > ns) {
        alert("Not Enough Stock.");
        return;
      }
      var f = confirm("Sell Stock\nTotal Amount: " + "₹ " + (num*Number(document.getElementById('cbp').innerHTML.slice(2))));
      if(f) {
        ns -= num;
        var bbbb = Number(document.getElementById('cbp').innerHTML.slice(2));
        avail = avail + (num*bbbb);
        document.getElementById('abl').innerHTML = avail;
        b = 1;

        document.getElementById('rt').innerHTML = `
            Order : Sell <br>
            Stock : ` + document.getElementById('companies').value + `<br>
            Qty : ` + num + `<br>
            At Price : ₹ ` + bbbb + `<br>
            Date : ` + curr_date + `<br>
        `;
      }
    }

    async function changeChart() {
      flag = false;
      var sd = document.getElementById('startdate').value;
      var ed = document.getElementById('enddate').value;
      var stock = document.getElementById('companies').value;

      var d = new Date(sd);
      var syear = d.getFullYear();
      var smonth = (d.getMonth() + 1) + "";
      smonth = smonth.length < 2 ? "0" + smonth : smonth;
      var sday = d.getDate() + "";
      sday = sday.length < 2 ? "0" + sday : sday;

      var startdate = syear + "-" + smonth + "-" + sday;

      for (d = new Date(sd); d <= new Date(ed); d.setDate(d.getDate() + 1)) {
        var year = d.getFullYear();
        var month = (d.getMonth() + 1) + "";
        month = month.length < 2 ? "0" + month : month;
        var day = d.getDate() + "";
        day = day.length < 2 ? "0" + day : day;

        var str = year + "-" + month + "-" + day;
        curr_date = str;
        fetch(`http://localhost:9000/getdata/` + startdate + '/' + str + '/' + stock)
          .then(res => res.json())
          .then(data => {
            cdata = data.map(d => {
              document.getElementById('cbp').innerHTML = "₹ " + d.Last_Price;
              // cbp*num + avail
              var n = d.Last_Price*ns + avail;
              n = n.toFixed(2);

              document.getElementById('portfolio').innerHTML = "₹ " + n; //+ port;
              return { time: d.Date, open: parseFloat(d.Open_Price), high: parseFloat(d.High_Price), low: parseFloat(d.Low_Price), close: parseFloat(d.Close_Price) }
            });
            candleSeries.setData(cdata);
          })
          .catch(err => log(err))

      }
    }
    document.getElementById('show-sidebar').addEventListener('click', function () {
  document.querySelector('.sidebar-wrapper').classList.toggle('active');
});

document.getElementById('close-sidebar').addEventListener('click', function () {
  document.querySelector('.sidebar-wrapper').classList.remove('active');
});



  </script>
</div>
